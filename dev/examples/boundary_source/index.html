<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A Boundary Source Problem · MinFEM.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="MinFEM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MinFEM.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../fem/">The Finite Element Method</a></li><li><a class="tocitem" href="../../gettingstarted/">Getting Started</a></li><li><a class="tocitem" href="../../paraview/">Visualization</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../poisson/">A Poisson Problem</a></li><li class="is-active"><a class="tocitem" href>A Boundary Source Problem</a></li><li><a class="tocitem" href="../elasticity/">A Vector-Valued Problem</a></li><li><a class="tocitem" href="../semilinear/">A Semi-Linear Problem</a></li><li><a class="tocitem" href="../parabolic/">A Time-Dependent Problem</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/public/">Public</a></li><li><a class="tocitem" href="../../lib/internals/">Internals</a></li></ul></li><li><a class="tocitem" href="../../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>A Boundary Source Problem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>A Boundary Source Problem</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/MinFEM/MinFEM.jl/blob/master/docs/src/examples/boundary_source.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="A-Boundary-Source-Problem"><a class="docs-heading-anchor" href="#A-Boundary-Source-Problem">A Boundary Source Problem</a><a id="A-Boundary-Source-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#A-Boundary-Source-Problem" title="Permalink"></a></h1><p>In the next example we concentrate on a boundary source term problem given by</p><p class="math-container">\[\begin{aligned}
-\Delta y = 0 &amp;\quad \text{in}\; \Omega\\
y = 0 &amp;\quad \text{on}\; \Gamma_0\\
\frac{\partial y}{\partial n} = f &amp;\quad \text{on}\; \Gamma_s
\end{aligned}\]</p><p>where the boundary <span>$\Gamma = \Gamma_0 \cup \Gamma_s$</span> is assumed to be composed of two disjoint parts.</p><p>Let <span>$V := \lbrace v \in H^1(\Omega):\, v\vert_{\Gamma_0} = 0\;\mathrm{a.e.} \rbrace$</span>. The variational formulation then reads as:</p><p>Find <span>$y \in V$</span> such that</p><p class="math-container">\[\int_{\Omega} \nabla y \cdot  \nabla v\, dx = \int_{\Gamma_s} f v \, ds
\quad \forall v \in V.\]</p><p>We now import a more interesting mesh and select the bottom and right boundary to be <span>$\Gamma_0$</span> as well as the left and top boundary to be <span>$\Gamma_s$</span> by</p><pre><code class="language-julia hljs">using MinFEM
mesh = import_mesh(&quot;../meshes/rounded.msh&quot;)

freeBoundary = select_boundaries(mesh, 1003, 1004)
freeElements = extract_elements(freeBoundary)
dirichletBoundary = select_boundaries(mesh, 1001, 1002)
dirichletNodes = extract_nodes(dirichletBoundary)</code></pre><p>The assembly of the stiffness matrix of the Laplacian is the same as for the plain Poisson problem. However, the mass matrix now has to discretize an integral over the boundary <span>$\Gamma_s$</span>. </p><p class="math-container">\[\int_{\Gamma_s} f v \, ds \quad \forall v \in V.\]</p><p>We thus call a different assembly routine, where we can specify the boundary elements to be <span>$\Gamma_s$</span>. Note that, if no boundary elements would be specified, the method will assume all physical boundaries of the mesh.</p><pre><code class="language-julia hljs">L = assemble_laplacian(mesh)
M = assemble_massmatrix_boundary(mesh, boundaryElements=freeElements)</code></pre><p>Then we define an inline function <code>f</code>, which we want to evaluate at the boundary nodes of <span>$\Gamma_s$</span>:</p><pre><code class="language-julia hljs">f(x) = x[1]^2 + x[2]^2
s = evaluate_mesh_function(mesh, f, freeBoundary)</code></pre><p>Notice that</p><pre><code class="language-julia hljs">length(s) == mesh.nnodes</code></pre><p>although <span>$s$</span> is intend to be defined on the boundary only. Yet, it is more comfortable to define <span>$s$</span> on all finite element nodes with 0 else than to keep track of which value belongs to which node.</p><p>Finally, we assemble PDE, solve it and write the output to a file for Paraview:</p><pre><code class="language-julia hljs">pde = PDESystem(A=L, b=M*s, bc=zeros(mesh.nnodes), DI=dirichletNodes)
solve!(pde)

write_to_vtk([pde.state, s], mesh, [&quot;Y&quot;,&quot;S&quot;], &quot;boundary_source&quot;)</code></pre><p>In Paraview, the visualization should then look similar to the following:</p><p><img src="../../assets/examples/result_boundary_source.png" alt="Result"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../poisson/">« A Poisson Problem</a><a class="docs-footer-nextpage" href="../elasticity/">A Vector-Valued Problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 5 May 2023 12:01">Friday 5 May 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
